<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»Šå¤©åƒä»€éº¼ï¼Ÿ(å¾©å¤æ‹‰éœ¸æ©Ÿç‰ˆ)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Righteous&family=Noto+Sans+TC:wght@500;900&display=swap');

        /* --- å…¨å±€è¨­å®š --- */
        body {
            font-family: 'Noto Sans TC', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a;
            background-image: radial-gradient(circle, #333 1px, transparent 1px);
            background-size: 20px 20px;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        /* --- æ‹‰éœ¸æ©Ÿæœ¬é«” --- */
        .slot-machine {
            width: 90%;
            max-width: 480px;
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            border-radius: 30px;
            padding: 20px;
            box-shadow: 
                0 0 0 10px #8e0000, /* å¤–æ¡† */
                0 20px 50px rgba(0,0,0,0.8), /* é™°å½± */
                inset 0 0 20px rgba(0,0,0,0.5);
            position: relative;
            border: 5px solid #ffd700; /* é‡‘é‚Š */
        }

        /* è£é£¾ç‡ˆæ³¡ (é ‚éƒ¨) */
        .lights-top {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
        }
        .bulb {
            width: 15px;
            height: 15px;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 0 10px #fff;
            animation: blink 1s infinite alternate;
        }
        .bulb:nth-child(even) { animation-delay: 0.5s; }

        h1 {
            text-align: center;
            font-family: 'Righteous', cursive;
            color: #ffeb3b;
            text-shadow: 2px 2px 0 #b71c1c, 0 0 15px #ffeb3b;
            margin: 0 0 20px 0;
            font-size: 2rem;
            letter-spacing: 2px;
        }

        /* --- é¸é …æ§åˆ¶å€ (é¢æ¿) --- */
        .control-panel {
            background: #333;
            border-radius: 15px;
            padding: 15px;
            border: 2px solid #555;
            margin-bottom: 20px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.8);
        }

        .group { margin-bottom: 15px; }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .btn-group { display: flex; gap: 8px; }
        .btn-group input { display: none; }
        .btn {
            flex: 1;
            padding: 8px;
            background: #444;
            border: 2px solid #222;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
            color: #888;
            transition: 0.2s;
            font-size: 0.9rem;
        }
        input:checked + .btn {
            background: #ff9800;
            color: #fff;
            border-color: #e65100;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            box-shadow: 0 0 10px #ff9800;
        }

        /* æ»‘æ¡¿æ¨£å¼ */
        input[type="range"] {
            width: 100%;
            height: 10px;
            background: #222;
            border-radius: 5px;
            outline: none;
            -webkit-appearance: none;
            border: 1px solid #555;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #ffeb3b;
            border: 2px solid #f57f17;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 235, 59, 0.5);
        }
        .price-display {
            text-align: right;
            color: #ffeb3b;
            font-weight: bold;
            font-family: 'Righteous', monospace;
            font-size: 1.1rem;
        }

        /* --- æ ¸å¿ƒ: æ»¾å‹•è¦–çª— (Window) --- */
        .window-frame {
            background: #000;
            padding: 10px;
            border-radius: 10px;
            border: 4px solid #f57f17; /* é‡‘æ¡† */
            box-shadow: inset 0 0 20px #000;
            margin-bottom: 20px;
            position: relative;
        }

        /* ç»ç’ƒåå…‰é®ç½© */
        .window-frame::after {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 50%;
            background: linear-gradient(to bottom, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
            pointer-events: none;
            z-index: 5;
        }

        .reel-container {
            height: 100px; /* è¦–çª—é«˜åº¦ */
            overflow: hidden; /* éš±è—è¶…å‡ºéƒ¨åˆ† */
            position: relative;
            background: white;
            border-radius: 5px;
        }

        /* æ»¾å‹•é•·æ¢ (Strip) */
        .reel-strip {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            /* åˆå§‹ä½ç½® */
            transform: translateY(0); 
        }

        /* æ»¾å‹•å‹•ç•« class */
        .is-spinning {
            transition: transform 3s cubic-bezier(0.1, 0.9, 0.2, 1); /* ç·©å‡ºæ•ˆæœï¼Œæ¨¡æ“¬ç‰©ç†æ‘©æ“¦åŠ› */
            /* åŠ ä¸Šå‹•æ…‹æ¨¡ç³Šæ•ˆæœå¢åŠ é€Ÿåº¦æ„Ÿ */
            filter: blur(1px); 
        }

        .is-stopped {
            transition: none;
            filter: blur(0);
        }

        /* å–®å€‹é£Ÿç‰©æ ¼å­ */
        .slot-item {
            height: 100px; /* å¿…é ˆè·Ÿè¦–çª—é«˜åº¦ä¸€æ¨£ */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: #333;
            border-bottom: 1px solid #eee;
            box-sizing: border-box;
            background-color: #fff;
        }
        /* å¶æ•¸æ ¼é¡è‰²å¾®èª¿ï¼Œå¢åŠ æ¢ç´‹æ„Ÿ */
        .slot-item:nth-child(even) {
            background-color: #f9f9f9;
        }

        /* --- æ‹‰æ¡¿æŒ‰éˆ• --- */
        #spinBtn {
            width: 100%;
            padding: 15px;
            font-size: 1.5rem;
            font-family: 'Righteous', cursive;
            color: white;
            background: linear-gradient(to bottom, #ff5252, #b71c1c);
            border: none;
            border-radius: 50px;
            border-bottom: 8px solid #7f0000;
            cursor: pointer;
            transition: 0.1s;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        #spinBtn:active {
            transform: translateY(5px);
            border-bottom-width: 3px;
            box-shadow: none;
        }
        
        #spinBtn:disabled {
            background: #555;
            border-bottom-color: #333;
            cursor: not-allowed;
            color: #888;
        }

        /* --- çµæœæ“ä½œå€ --- */
        .action-area {
            margin-top: 15px;
            display: none;
            gap: 10px;
        }
        
        .action-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            font-size: 0.9rem;
        }
        .map-btn { background: #2196f3; color: white; }
        .retry-btn { background: #757575; color: white; }

        @keyframes blink {
            from { opacity: 0.3; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>

    <div class="slot-machine">
        <div class="lights-top">
            <div class="bulb"></div><div class="bulb"></div><div class="bulb"></div><div class="bulb"></div><div class="bulb"></div>
        </div>

        <h1>WHAT TO EAT</h1>

        <div class="window-frame">
            <div class="reel-container">
                <div id="reelStrip" class="reel-strip">
                    <div class="slot-item">æº–å‚™é–‹åƒ</div>
                </div>
            </div>
        </div>

        <div class="control-panel">
            <div class="group">
                <div class="btn-group">
                    <input type="radio" id="savory" name="flavor" value="é¹¹" checked>
                    <label for="savory" class="btn">ğŸœ é¹¹é£Ÿ</label>
                    <input type="radio" id="sweet" name="flavor" value="ç”œ">
                    <label for="sweet" class="btn">ğŸ° ç”œé»</label>
                </div>
            </div>
            <div class="group">
                <div class="btn-group">
                    <input type="radio" id="hot" name="temp" value="ç†±" checked>
                    <label for="hot" class="btn">ğŸ”¥ ç†±å‘¼å‘¼</label>
                    <input type="radio" id="cold" name="temp" value="å†·">
                    <label for="cold" class="btn">â„ï¸ é€å¿ƒæ¶¼</label>
                </div>
            </div>
            <div class="group">
                <label>é ç®— Budget</label>
                <div class="price-display" id="priceDisplay">NT$ 0 - 150</div>
                <input type="range" id="budget" min="1" max="4" value="1" step="1">
            </div>
        </div>

        <button id="spinBtn">ğŸ° SPIN</button>

        <div id="actionArea" class="action-area">
            <a id="mapLink" href="#" target="_blank" class="action-btn map-btn">ğŸ“ Google Map</a>
            <button id="retryBtn" class="action-btn retry-btn">å†è½‰ä¸€æ¬¡</button>
        </div>
    </div>

    <script>
        /* --- 1. å¤§å¹…æ“´å……çš„é£Ÿç‰©è³‡æ–™åº« (ç‰¹åˆ¥æ˜¯ 0-150å…ƒ) --- */
        const foodDatabase = [
            // --- é¹¹ + ç†± (å¹³åƒ¹ç‹è€…) ---
            { name: "æ»·è‚‰é£¯+ç‡™é’èœ", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "é›è‚‰é£¯ä¾¿ç•¶", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "å¤æ—©å‘³é™½æ˜¥éºµ", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "éº»é†¬éºµ+è›‹èŠ±æ¹¯", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "å…«æ–¹é›²é›†/é‹è²¼", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "é«˜éº—èœæ°´é¤ƒ", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "ç”œä¸è¾£/é—œæ±ç…®", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "å½°åŒ–è‚‰åœ“", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "å¤§è…¸èšµä»”éºµç·š", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "å°å¼è‡­è±†è…", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "å»£æ±ç²¥/çš®è›‹ç˜¦è‚‰ç²¥", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "æ½¤é¤… (æ˜¥æ²)", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "åˆˆåŒ… (è™å’¬è±¬)", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "æ—©é¤åº—è›‹é¤…+è˜¿è””ç³•", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "æ’éª¨é£¯ä¾¿ç•¶", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "ç±³ç²‰æ¹¯+é»‘ç™½åˆ‡", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "é´¨è‚‰é£¯", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "ä¾¿åˆ©å•†åº—å¾®æ³¢é£Ÿå“", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "é…¸è¾£æ¹¯é¤ƒ", price: 1, flavor: "é¹¹", temp: "ç†±" },
            { name: "éµæ¿éºµ (è˜‘è‡/é»‘èƒ¡æ¤’)", price: 1, flavor: "é¹¹", temp: "ç†±" },
            
            // --- é¹¹ + ç†± (ä¸­é«˜åƒ¹ä½) ---
            { name: "ç‰›è‚‰éºµ", price: 2, flavor: "é¹¹", temp: "ç†±" },
            { name: "å€‹äººå°ç«é‹", price: 2, flavor: "é¹¹", temp: "ç†±" },
            { name: "éº¥ç•¶å‹/è‚¯å¾·åŸº", price: 2, flavor: "é¹¹", temp: "ç†±" },
            { name: "æ—¥å¼è±šéª¨æ‹‰éºµ", price: 3, flavor: "é¹¹", temp: "ç†±" },
            { name: "éŸ“å¼ç‚¸é›", price: 3, flavor: "é¹¹", temp: "ç†±" },
            { name: "ç¾©å¤§åˆ©éºµ", price: 3, flavor: "é¹¹", temp: "ç†±" },
            { name: "éµæ¿ç‡’å¥—é¤", price: 3, flavor: "é¹¹", temp: "ç†±" },
            { name: "ç‹å“ç‰›æ’", price: 4, flavor: "é¹¹", temp: "ç†±" },
            { name: "éº»è¾£é‹åƒåˆ°é£½", price: 4, flavor: "é¹¹", temp: "ç†±" },
            { name: "é¼æ³°è±", price: 4, flavor: "é¹¹", temp: "ç†±" },

            // --- é¹¹ + å†· ---
            { name: "ä¾¿åˆ©å•†åº—æ¶¼éºµ", price: 1, flavor: "é¹¹", temp: "å†·" },
            { name: "å¾¡é£¯ç³°/æ‰‹å·", price: 1, flavor: "é¹¹", temp: "å†·" },
            { name: "ç‡Ÿé¤Šä¸‰æ˜æ²»", price: 1, flavor: "é¹¹", temp: "å†·" },
            { name: "SUBWAY æ½›è‰‡å ¡", price: 2, flavor: "é¹¹", temp: "å†·" },
            { name: "å‡±è–©æ²™æ‹‰ç›†", price: 2, flavor: "é¹¹", temp: "å†·" },
            { name: "è¶Šå¼ç”Ÿæ˜¥æ²", price: 2, flavor: "é¹¹", temp: "å†·" },
            { name: "å†·æ»·å‘³", price: 2, flavor: "é¹¹", temp: "å†·" },
            { name: "çˆ­é®®å£½å¸", price: 2, flavor: "é¹¹", temp: "å†·" },
            { name: "è±ªè¯ç”Ÿé­šç‰‡ä¸¼é£¯", price: 3, flavor: "é¹¹", temp: "å†·" },
            { name: "Omakase ç„¡èœå–®å£½å¸", price: 4, flavor: "é¹¹", temp: "å†·" },

            // --- ç”œ + ç†± ---
            { name: "ç´…è±†é¤…/è»Šè¼ªé¤…", price: 1, flavor: "ç”œ", temp: "ç†±" },
            { name: "å¤æ—©å‘³é›è›‹ç³•", price: 1, flavor: "ç”œ", temp: "ç†±" },
            { name: "å¤œå¸‚åœ°ç“œçƒ", price: 1, flavor: "ç”œ", temp: "ç†±" },
            { name: "ç‡’ä»™è‰", price: 1, flavor: "ç”œ", temp: "ç†±" },
            { name: "ç†±è±†èŠ± (åŠ è–‘æ±)", price: 1, flavor: "ç”œ", temp: "ç†±" },
            { name: "ç´…è±†æ¹¯/èŠ±ç”Ÿæ¹¯", price: 1, flavor: "ç”œ", temp: "ç†±" },
            { name: "ç†±å¯å¯+è»Ÿé¤…ä¹¾", price: 2, flavor: "ç”œ", temp: "ç†±" },
            { name: "å‰›å‡ºçˆè›‹å¡”", price: 2, flavor: "ç”œ", temp: "ç†±" },
            { name: "èˆ’èŠ™è•¾é¬†é¤…", price: 3, flavor: "ç”œ", temp: "ç†±" },
            { name: "ç¾çƒ¤å¸ƒæœ—å°¼", price: 3, flavor: "ç”œ", temp: "ç†±" },

            // --- ç”œ + å†· ---
            { name: "æ‰‹æ–é£² (åŠç³–å°‘å†°)", price: 1, flavor: "ç”œ", temp: "å†·" },
            { name: "å¤æ—©å‘³å†°è±†èŠ±", price: 1, flavor: "ç”œ", temp: "å†·" },
            { name: "ä»™è‰èœœ/æ„›ç‰å†°", price: 1, flavor: "ç”œ", temp: "å†·" },
            { name: "ç¶ è±†æ¹¯/è–ä»æ¹¯", price: 1, flavor: "ç”œ", temp: "å†·" },
            { name: "ä¾¿åˆ©å•†åº—éœœæ·‡æ·‹", price: 1, flavor: "ç”œ", temp: "å†·" },
            { name: "æ³¡èŠ™", price: 1, flavor: "ç”œ", temp: "å†·" },
            { name: "å‰‰å†°/é›ªèŠ±å†°", price: 2, flavor: "ç”œ", temp: "å†·" },
            { name: "ç²¾ç·»åˆ‡ç‰‡è›‹ç³•", price: 2, flavor: "ç”œ", temp: "å†·" },
            { name: "å“ˆæ ¹é”æ–¯è–ä»£", price: 3, flavor: "ç”œ", temp: "å†·" },
            { name: "äº”æ˜Ÿé£¯åº—ä¸‹åˆèŒ¶", price: 4, flavor: "ç”œ", temp: "å†·" }
        ];

        /* --- 2. åˆå§‹åŒ–è®Šæ•¸ --- */
        const budgetInput = document.getElementById('budget');
        const priceDisplay = document.getElementById('priceDisplay');
        const spinBtn = document.getElementById('spinBtn');
        const retryBtn = document.getElementById('retryBtn');
        const reelStrip = document.getElementById('reelStrip');
        const actionArea = document.getElementById('actionArea');
        const mapLink = document.getElementById('mapLink');

        const priceRanges = ["NT$ 0 - 150", "NT$ 150 - 500", "NT$ 500 - 1500", "NT$ 1500 - 10000+"];
        const ITEM_HEIGHT = 100; // å°æ‡‰ CSS .slot-item çš„é«˜åº¦

        // æ»‘æ¡¿é€£å‹•æ–‡å­—
        budgetInput.addEventListener('input', function() {
            priceDisplay.textContent = priceRanges[this.value - 1];
        });

        // æŒ‰éˆ•ç›£è½
        spinBtn.addEventListener('click', startSpin);
        retryBtn.addEventListener('click', resetAndSpin);

        function resetAndSpin() {
            // é‡ç½®ä½ç½®åˆ°é ‚éƒ¨ï¼Œä¸å¸¶å‹•ç•«
            reelStrip.classList.remove('is-spinning');
            reelStrip.style.transform = `translateY(0px)`;
            
            // å¼·åˆ¶ç€è¦½å™¨é‡ç¹ª (Reflow)ï¼Œç¢ºä¿ä¸‹ä¸€æ­¥å‹•ç•«æœƒè§¸ç™¼
            void reelStrip.offsetWidth;
            
            // é‡æ–°é–‹å§‹
            startSpin();
        }

        function startSpin() {
            // 1. å–å¾—ç¯©é¸æ¢ä»¶
            const flavor = document.querySelector('input[name="flavor"]:checked').value;
            const temp = document.querySelector('input[name="temp"]:checked').value;
            const budgetLevel = parseInt(budgetInput.value);

            // 2. ç¯©é¸è³‡æ–™
            let candidates = foodDatabase.filter(food => 
                food.flavor === flavor && food.temp === temp && food.price <= budgetLevel
            );

            // é˜²å‘†ï¼šå¦‚æœçœŸçš„æ‰¾ä¸åˆ° (ä¾‹å¦‚è±ªè¯+å†·é£Ÿå¯èƒ½å¾ˆå°‘)ï¼Œå°±æ”¾å¯¬æ¨™æº–
            if (candidates.length === 0) {
                candidates = [{name: "æ‰¾ä¸åˆ°...æ›å€‹æ¢ä»¶å§", price: 0}];
            }

            // 3. æº–å‚™ã€Œæ»¾å‹•é•·æ¢ã€çš„å…§å®¹
            // æˆ‘å€‘è¦å»ºç«‹ä¸€é•·ä¸²çš„ HTMLï¼Œæœ€å¾Œä¸€å€‹æ˜¯ã€Œä¸­ççµæœã€
            // ç‚ºäº†çœ‹èµ·ä¾†åœ¨éš¨æ©Ÿè·‘ï¼Œæˆ‘å€‘éš¨æ©ŸæŠ“å– candidates å¡«å……å‰é¢çš„ä½ç½®
            const TOTAL_ITEMS = 30; // æ»¾å‹•ç¸½é•·åº¦ (æ ¼æ•¸)
            let stripHTML = '';
            
            // éš¨æ©Ÿé¸ä¸€å€‹ã€Œæœ€çµ‚è´å®¶ã€
            const winner = candidates[Math.floor(Math.random() * candidates.length)];

            // å»ºæ§‹å‰ 29 å€‹éš¨æ©Ÿé …ç›® (è®“è¦–è¦ºçœ‹èµ·ä¾†åœ¨è·‘)
            for (let i = 0; i < TOTAL_ITEMS - 1; i++) {
                const randomItem = candidates[Math.floor(Math.random() * candidates.length)];
                stripHTML += `<div class="slot-item">${randomItem.name}</div>`;
            }

            // åŠ å…¥æœ€å¾Œä¸€å€‹ã€Œè´å®¶ã€
            stripHTML += `<div class="slot-item" style="color:#d32f2f; font-size: 2rem;">${winner.name}</div>`;

            // æ›´æ–° DOM
            reelStrip.innerHTML = stripHTML;
            
            // éš±è—èˆŠçš„æŒ‰éˆ•
            actionArea.style.display = 'none';
            spinBtn.disabled = true;
            spinBtn.textContent = "SPINNING...";

            // 4. åŸ·è¡Œæ»¾å‹•å‹•ç•«
            // è¨ˆç®—ç›®æ¨™ä½ç½®ï¼šå‘ä¸Šç§»å‹• (ç¸½æ ¼æ•¸ - 1) * é«˜åº¦
            // å› ç‚ºè¦–çª—åªèƒ½çœ‹åˆ°ä¸€å€‹ï¼Œæˆ‘å€‘è¦è®“æœ€å¾Œä¸€å€‹åœåœ¨è¦–çª—å…§
            // æ‰€ä»¥è¦ç§»å‹•çš„è·é›¢ = -(ç¸½é•·åº¦ - 1) * 100px
            const targetY = -(TOTAL_ITEMS - 1) * ITEM_HEIGHT;

            // åŠ ä¸Šå‹•ç•« Class
            requestAnimationFrame(() => {
                reelStrip.classList.add('is-spinning');
                reelStrip.style.transform = `translateY(${targetY}px)`;
            });

            // 5. å‹•ç•«çµæŸå¾Œçš„è™•ç† (3ç§’å¾Œ)
            setTimeout(() => {
                reelStrip.classList.remove('is-spinning');
                reelStrip.classList.add('is-stopped'); // ç§»é™¤æ¨¡ç³Š
                
                spinBtn.disabled = false;
                spinBtn.textContent = "ğŸ° SPIN AGAIN";
                actionArea.style.display = 'flex';
                
                // è¨­å®šåœ°åœ–é€£çµ
                mapLink.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(winner.name)}`;
                
            }, 3000); // é€™è£¡è¦è·Ÿ CSS çš„ transition æ™‚é–“ä¸€æ¨£ (3s)
        }
    </script>
</body>
</html>
